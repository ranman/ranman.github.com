<!DOCTYPE html>
<html>
<head>
<script src="../scripts/jquery.min.js"></script>
<script src="../scripts/jquery.easing.js"></script>
<script src="../scripts/jquery-css-transform.js"></script>
<script src="../scripts/jquery-animate-css-rotate-scale.js"></script>
<script src="../scripts/jquery.quicksand.js"></script>
<script src="../scripts/jquery.textsand.js"></script>
<script type="text/javascript">
var API_KEY = 'AIzaSyBIFRz6sfJ1wq7LqykoXeYA3R37Wt5KM9o'
var API_URL = 'https://www.googleapis.com/language/translate/v2?callback=?'
//Update text to translate
function updateText() {
    $('#textToTranslate').empty().append(
        //Clean up the input
        $('#inputBox').val()
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        );
}
//Update the duration slider value
function showValue(newValue) {
    document.getElementById("durationNum").innerHTML=newValue;
}

//When the document has loaded
$(document).ready(function() {
    //Update every second incase someone pastes something in or the spellchecker udpates.
    var intervalID = window.setInterval(updateText, 1000);
    //Update on every keyup event
    $('#inputBox').bind('keyup', function(e) {
        updateText();
    });

    function translate() {
        //Unbind the update every second and keyup 
        $('#inputBox').unbind('keyup', updateText);
        window.clearInterval(intervalID);
        
        //Get the source, target, and query
        var src = $("#sourceLanguage");
        var tgt = $("#targetLanguage");
        var textToTranslate = $('#textToTranslate');
        var animateDuration = parseInt($('#duration').val());

        //Disable everything while we're updating
        src.attr('disabled', 'disabled');
        tgt.attr('disabled', 'disabled');
        $('#translateButton').attr('disabled', 'disabled');
        $('#inputBox').attr('disabled', 'disabled');

        //Get the translation from Google
        $.getJSON(API_URL,
          {
            key: API_KEY,
            source: src.val(),
            target: tgt.val(),
            q: textToTranslate.html()
          },
          //On success, animate in the new data.
          function(data) {
            if(data.data.translations) {
                //Make sure the data is there, otherwise error.
                textToTranslate
                .textsand($('<h1>'+data.data.translations[0].translatedText+'</h1>'), { 'duration' : animateDuration });
            } else {
                textToTranslate.textsand($('<h1>There was an error</h1>'));
            }
          }).error(function() {
            textToTranslate.textsand($('<h1>There was an error</h1>'));
          })
          //When done change source language to target langauge
          .complete(function() {
              var tempVal = src.val();
              src.val(tgt.val())
              tgt.val(tempVal);
          });
          //Re-enable inputs after the animation is done.
          setTimeout(function() { 
            src.removeAttr('disabled');
            tgt.removeAttr('disabled');
            $('#translateButton').removeAttr('disabled');
            $('#inputBox').removeAttr('disabled'); }, 
            animateDuration+50);
    }
    $('#translateButton').click(translate);
});
</script>
</head>
<body>
<div style="margin: 0 auto; width: 50%">
<h3>This is a demonstration of a textual animation plugin I wrote. Notice how the letters move to the nearest position that they appear in the target text. Letters not present in the source text have an ease/alpha effect and appear while the other letters are transitioning.</h3>
<input id="inputBox" size="70" type="text"></input>
<h1 id="textToTranslate"></h1>
<input id="translateButton" type="button" value="Translate"></input>
<select id="sourceLanguage">
    <option value="af">Afrikaans</option>   
    <option value="sq">Albanian</option>
    <option value="ar">Arabic</option>
    <option value="be">Belarusian</option> 
    <option value="bg">Bulgarian</option> 
    <option value="ca">Catalan</option> 
    <option value="zh-CN">Chinese Simplified</option>
    <option value="zh-TW">Chinese Traditional</option>
    <option value="hr">Croatian</option> 
    <option value="cs">Czech</option> 
    <option value="da">Danish</option> 
    <option value="nl">Dutch</option> 
    <option value="en" selected="selected">English</option> 
    <option value="et">Estonian</option> 
    <option value="tl">Filipino</option> 
    <option value="fi">Finnish</option> 
    <option value="fr">French</option> 
    <option value="gl">Galician</option> 
    <option value="de">German</option> 
    <option value="el">Greek</option> 
    <option value="ht">Haitian Creole</option>
    <option value="iw">Hebrew</option> 
    <option value="hi">Hindi</option> 
    <option value="hu">Hungarian</option> 
    <option value="is">Icelandic</option> 
    <option value="id">Indonesian</option> 
    <option value="ga">Irish</option> 
    <option value="it">Italian</option> 
    <option value="ja">Japanese</option> 
    <option value="lv">Latvian</option> 
    <option value="lt">Lithuanian</option> 
    <option value="mk">Macedonian</option> 
    <option value="ms">Malay</option> 
    <option value="mt">Maltese</option> 
    <option value="no">Norwegian</option> 
    <option value="fa">Persia</option> 
    <option value="pl">Polish</option> 
    <option value="pt">Portuguese</option> 
    <option value="ro">Romanian</option> 
    <option value="ru">Russian</option> 
    <option value="sr">Serbian</option> 
    <option value="sk">Slovak</option> 
    <option value="sl">Slovenian</option> 
    <option value="es">Spanish</option> 
    <option value="sw">Swahili</option> 
    <option value="sv">Swedish</option> 
    <option value="th">Thai</option> 
    <option value="tr">Turkish</option> 
    <option value="uk">Ukrainian</option> 
    <option value="vi">Vietnamese</option> 
    <option value="cy">Welsh</option> 
    <option value="yi">Yiddish</option> 
</select>
<select id="targetLanguage">
    <option value="af">Afrikaans</option>   
    <option value="sq">Albanian</option>
    <option value="ar">Arabic</option>
    <option value="be">Belarusian</option> 
    <option value="bg">Bulgarian</option> 
    <option value="ca">Catalan</option> 
    <option value="zh-CN">Chinese Simplified</option>
    <option value="zh-TW">Chinese Traditional</option>
    <option value="hr">Croatian</option> 
    <option value="cs">Czech</option> 
    <option value="da">Danish</option> 
    <option value="nl">Dutch</option> 
    <option value="en">English</option> 
    <option value="et">Estonian</option> 
    <option value="tl">Filipino</option> 
    <option value="fi">Finnish</option> 
    <option value="fr">French</option> 
    <option value="gl">Galician</option> 
    <option value="de" selected="selected">German</option> 
    <option value="el">Greek</option> 
    <option value="ht">Haitian Creole</option>
    <option value="iw">Hebrew</option> 
    <option value="hi">Hindi</option> 
    <option value="hu">Hungarian</option> 
    <option value="is">Icelandic</option> 
    <option value="id">Indonesian</option> 
    <option value="ga">Irish</option> 
    <option value="it">Italian</option> 
    <option value="ja">Japanese</option> 
    <option value="lv">Latvian</option> 
    <option value="lt">Lithuanian</option> 
    <option value="mk">Macedonian</option> 
    <option value="ms">Malay</option> 
    <option value="mt">Maltese</option> 
    <option value="no">Norwegian</option> 
    <option value="fa">Persia</option> 
    <option value="pl">Polish</option> 
    <option value="pt">Portuguese</option> 
    <option value="ro">Romanian</option> 
    <option value="ru">Russian</option> 
    <option value="sr">Serbian</option> 
    <option value="sk">Slovak</option> 
    <option value="sl">Slovenian</option> 
    <option value="es">Spanish</option> 
    <option value="sw">Swahili</option> 
    <option value="sv">Swedish</option> 
    <option value="th">Thai</option> 
    <option value="tr">Turkish</option> 
    <option value="uk">Ukrainian</option> 
    <option value="vi">Vietnamese</option> 
    <option value="cy">Welsh</option> 
    <option value="yi">Yiddish</option>
</select>
<br />
Duration:
<input id="duration" type="range" min="500" max="10000" value="4000" step="10" onchange="showValue(this.value)"/>
<span id="durationNum">4000</span>
</div>
</body>
</html>
